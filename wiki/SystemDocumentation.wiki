#summary Catz system documentation

= Controllers and controller methods =

Here is a list of all controllers and the descriptions of all methods in controllers.

== Base ==

The base class for all controllers.

|| *Method* || *Purpose* ||
|| fetch || fetch data from any model (the Model access interface) ||
|| redirect_perm || issue a permanent HTTP redirect ||
|| redirect_temp || issue a temporary HTTP redirect ||
|| not_found || reject the request and generated HTTP not found ||

== Locate ==

The collection of methods for functions to locate the subjects and photos.

|| *Method* || *Purpose* ||
|| process_width || processes the width GET parameter to stash ||
|| find || the quick find action (the subjects via AJAX) ||
|| list || the list action ||
|| sample || the sample action (sample photos via AJAX) ||
|| search || the advanced search action ||

== Main ==

The controller to provide front page and misc functions.

|| *Method* || *Purpose* ||
|| detect || the root action to issue a redirect to the correct langauge branch ||
|| front || the front page action ||
|| reset || the reset stylesheet action ||
|| base || the system stylesheet action ||
|| set || the system setup change action (AJAX) ||
|| result || the show result action (AJAX) ||

== New ==

The controller for news.

|| *Method* || *Purpose* ||
|| news || the news action ||
|| feed || the RSS news feed providing action ||

== Present ==

The Controller for photo browsing and viewing.

|| *Method* || *Purpose* ||
|| process_id || processes the GET id parameter and handles situations without the parameter ||
|| process_args || processes the GET parameters ||
|| browse || the browse action (photo browsing) ||
|| view || the view action (photo viewing) ||

= Templates =

Templates are divided to folders by their purpose. The folders have on subfolders.

== Root level templates ==

|| exception || || 
|| not_found || || 

== block ==

== elem ==

== frame ==

== link ==

== move ==

== page ==

== prim ==

== stripe ==

== style ==
 
= Stash variables =

Stash variables are named in such a way that one name is used only in one purpose. Mojolicious' default stash variables are not listed here.

|| *Variable* || *Purpose* || *Set by* ||
|| album || the data for the front page albums list || Main::front ||
|| args_array || the GET parameters as an arrayref key1, value1, key2, value2, ... || Present::process_args Locate::search ||
|| args_count || the number of GET parameters || Present::process_args Locate::search ||
|| args_string || GET parameters in string format ready to be printed out || Present::process_args Locate::search ||
|| attrib || the cat attribute got with show result from the www.catshow.fi interface || Main::result || 
|| cached || internal flag that is set to true when a page comes from the page cache || before_dispatch ||
|| comment || the comment texts of a current photo as an arrayref || Present::view ||
|| count_find || the number subject presented on front page on quick find || Locate::process_width ||
|| count_thumb || the number of thumbnails presented on front page || Locate::process_width ||
|| detail || the set of subjects related to the current photo to be presented in photo viewing || Present::view ||
|| display || the setup/cookie value to control what data is presented in photo viewing || Setup::setup_init ||
|| earliest || the date of the earliest photo in the current page or in the result set of advanced search || Present::browse Locate::search ||
|| find || the find result set || Locate::find ||
|| from || the natural photo number of the first photo in the photo set on the current page || Present::browse ||
|| found || the number of photos found in advanded search || Locate::search ||
|| googlekey || the site's key of Google Analytics || before_dispatch ||
|| id || the photo id of the current photo, is of format 999999 where first 999 indicates the album and last 999 the photo number within the album || Present::process_id ||
|| idparam || set to contain the URL get parameter part for and id to ease the URL generation, can also be empty || Present::process_id ||
|| image || the photo to be viewed in photo viewing || Present::view ||
|| lang || the language of the current request, practically can be 'en' or 'fi' || before_dispatch ||
|| langother || the url for the same page in the opposite language, makes easy to provide the langauge change link in template || before_dispatch || 
|| latest || the date of the latest photo in the current page or in the result set of advanced search || Present::browse Locate::search ||
|| list || the list content || List ||
|| maxx || the maximum value of the runtime photo id and also the total number of the photos in the system || Main::front ||
|| meta_follow || flag defaulting true that controls the robots meta tag || before_dispatch ||
|| meta_index || flag defaulting true that controls  the robots meta tag || before_dispatch ||
|| mode || the mode of a list || route (for List) ||
|| new || the data for the front page news list || Main::front ||
|| now || the current date and time in language specific format (ready to be printed out) || before_dispatch ||
|| origin || the origin of the id of the current photo, set to 'id' if photo id was given in URL, set to 'x' if the id was resolved by the system || Present::process_id ||
|| result || the show result fetched from the www.catshow.fi interface || Main::result ||
|| pad || set to '' or '?' to ease the URL generation to be used in URL get parameter generation || Present::process_id ||
|| page || the current page number where we are on in the current set || Present::browse Present::view ||
|| pages || the nubmer of pages in the current set || Present::browse Present::view ||
|| palette || the setup/cookie value to control the tone palette presented by the system || Setup::setup_init ||
|| perpage || the setup/cookie value to control how many thumbnails are shown in photo browsing || Setup::setup_init ||
|| photobase || the beginning of URL for all image presenting IMG tags, this is where all the images come from, allows development to easlily use production server for serving images || before_dispatch ||
|| photosize || the setup/cookie value to control how the big photo is preseneted in photo viewing || Setup::setup_init ||
|| pri || the data for the front page subject list || Main::front ||
|| pin || an arrayref to contain navigation targets for page or photo navigation as first, previous, next, last || Present::browse Present::view ||
|| pos || the natural photo number the current photo in the current set || Present::view ||
|| sep || the item separator character or string used in all free-floating lists || before_dispatch ||
|| subject || the subject of a list || route (for List) ||
|| t || the text hashref used all over the templates to print out the texts presented to the user, set to contain the texts of the requested language || before_dispatch ||
|| thumb || the set of thumbnails to be presented || Present::browse Locate::sample Locate::search ||
|| thumbsize || the setup/cookie value to control the thumbnail size in photo browsing || Setup::setup_init ||
|| to || the natural photo number of the last photo in the photo set on the current page || Present::browse ||
|| total || the total number of photos in the current set || Present::browse Present::view ||
|| url || the effective URL of the request || before_dispatch ||
|| version || the data version the system is running on expressed as integer YYYYDDMMHHMMSS or 0 = latest || before_dispatch || 
|| what || the what GET parameter of quick find and advanced search || Locate::find Locate::search ||
|| x || the runtime number of the current photo, is an integer starting from 1 || Present::process_id ||
|| xs || the runtime numbers of the photos on the current page in correct presentation order || Present::browse ||
